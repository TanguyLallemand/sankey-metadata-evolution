# Generation Of a Gene Ontology Template

## Why this script is needed?
Python parser used to generate different graphs though time need a template for each node involved. The choice of nodes involved was based on the lowest level nodes of Gene Ontology in its Slim version. Thus, this script aims to build the sankey diagram of the GO slim and extract the nodes of the last levels in order to build a JSON serving as node models.

## Launch this script

Example of call:
./get_metadata.py
It will launch script using default paths, stored in ./src/configuration_metadata.ini
If script is launched using arguments here is the documentation to use them:

    usage: get_metadata.py [-h] [-p [METADATAPATH]] [-t [METADATATEMPLATE]]
                         [-c [CORGIPATH]] [-o [OUTPUTPATH]]

    optional arguments:
      -h, --help            show this help message and exit
      -p [METADATAPATH], --metadataPath [METADATAPATH]
                            Give a path to access to metadata file
      -t [METADATATEMPLATE], --metadataTemplate [METADATATEMPLATE]
                            Give a path to access to a template of metadata file
                            needed by d3.js
      -c [CORGIPATH], --corgiPath [CORGIPATH]
                            Give a path to access to CoRGI output file
      -o [OUTPUTPATH], --outputPath [OUTPUTPATH]
                            Give a path to output JSON file

## Input

Input file is a JSON file in a node-link format. GoSlim is downloaded in latest version from GO website using following URL: http://current.geneontology.org/ontology/subsets/goslim_plant.json
GO is downloaded is Json format, needing few modification done by parser. Here a sample of final file whith indentation (real file is minified in order to try to reduce the file to a minimum).
./data/output/goslim_plant.json

    "graphs": [
    {
      "nodes": [
        {
          "id": "GO:0005615",
          "meta": {
            "definition": {...},
            "comments": ["..."],
            "subsets": ["..."],
            "xrefs": [{
              "val": "..."
            }],
            "synonyms": [{
                "pred": "...",
                "val": "...",
                "xrefs": []
              }],
            "basicPropertyValues": [{
                "pred": "...",
                "val": "..."}
            ]},
          "type": "...",
          "lbl": "..."
        }],
        "edges": [
            {
              "source": "GO:0016043",
              "pred": "is_a",
              "target": "GO:0009987"
            },

## Output

The output file is a minified JSON file gathering all the information of the nodes of the last level of the slim GO. It is presented in the following form:

    "nodes": [
      {
        "id": "GO:0005615",
        "meta": {
          "definition": {...},
          "comments": ["..."],
          "subsets": ["..."],
          "xrefs": [{
            "val": "..."
          }],
          "synonyms": [{
              "pred": "...",
              "val": "...",
              "xrefs": []
            }],
          "basicPropertyValues": [{
              "pred": "...",
              "val": "..."}
          ]},
        "type": "...",
        "lbl": "..."
      }]

## Algorithm

The algorithm has been implemented in JAvascript because the d3 library has a module allowing the generation of a sankey diagram in a relatively easy way. Thus, the generation of this diagram will modify the JSON object loaded in memory so that each node stores the source and target nodes with which they are involved, which makes it very easy to extract the nodes from the last level by extracting all nodes that do not have target nodes, which implies that they are on the last level. This approach is relatively light since the sankey diagram is only built in memory and never displayed, which allows you to have a light script. All the user has to do is click on downloaded to retrieve the JSON file generated by the script.
