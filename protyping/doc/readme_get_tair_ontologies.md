# TAIR approach

## Input
Data comes from Corgi matrix and are located in: ./data/initial/catma5_probes.json. This file gather all genes involved in CoRGI matrix in a dictionnary of object. Each object store a gene ID and a probe ID. Here is a sample of this file gathering an array of lists. Each of those lists

    {
      "1": {
        "atg": "AT1G15000",
        "probe": "CATMA1A13980"
      },
      "2": {
        "atg": "AT4G01130",
        "probe": "CATMA4A01300"
      }
    }

## Output
Three files are outputed by this script corresponding to the three different parts of the parser. Here is a sample of each file generated by this script.

Gene information are downloaded from TAIR database, using this tool https://www.arabidopsis.org/tools/bulk/go/index.jsp, allowing to generate a Tab-separated file from a list of gene ID. TSV file is parsed in order to produce a file like sample given after.

./data/output/geneInformations.json

    {
      "AT1G47317": [{
        "GO_ID": "GO:0005576",
        "GO_Term": "extracellular region",
        "GOslim_reference": "extracellular",
        "Cat": "comp",
        "Evidence_code": "ISM",
        "Model": "AT1G47317.1"}
        }
    }


GoSlim is downloaded in latest version from GO website using following URL: http://current.geneontology.org/ontology/subsets/goslim_plant.json
GO is downloaded is Json format, needing few modification done by parser. Here a sample of final file whith indentation (real file is minified in order to try to reduce the file to a minimum).
./data/output/goslim_plant.json

    "graphs": [
    {
      "nodes": [
        {
          "id": "GO:0005615",
          "meta": {
            "definition": {...},
            "comments": ["..."],
            "subsets": ["..."],
            "xrefs": [{
              "val": "..."
            }],
            "synonyms": [{
                "pred": "...",
                "val": "...",
                "xrefs": []
              }],
            "basicPropertyValues": [{
                "pred": "...",
                "val": "..."}
            ]},
          "type": "...",
          "lbl": "..."
        }],
        "edges": [
            {
              "source": "GO:0016043",
              "pred": "is_a",
              "target": "GO:0009987"
            },

To finish, a Json file (./data/output/GOAndMappendGenesJson.json) is produced gathering gene informations from TAIR database mapped on GO slim. This mapping is done using GOslim_reference, a high level GO term helping in functional categorization. So, for each nodes an array called mappedGene gather TAIR informations (example in sample ./data/output/geneInformations.json).

The validation of this enrichment could be done by seeing that node with label "nucleotide binding" has a mappedGenes array of 241 object which his validated by following giving save result

    grep -o '"GOslim_reference": "nucleotide binding",' geneInformations.json | wc -l

## Algorithm

This script works in three main parts:
- First download and parsing of the gene Ontology from a URL given by the user in the configuration file or when calling the script.
- Then, parsing the Catma file, extracting the gene IDs which will then be used to request on the TAIR database and retrieve the annotations of these genes. These annotations will be used to build a Json file.
- Finally, the gene annotations will be added to the Json of the gene Ontology to obtain a file where for each ontology are gathered all the genes that are annotated via this ontology.
